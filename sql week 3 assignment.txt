1. SELECT CUSTOMER_ID, SUM(ORDER_TOTAL) AS TOTAL_AMOUNT_SPENT
FROM DEMO_ORDERS
GROUP BY CUSTOMER_ID
ORDER BY TOTAL_AMOUNT_SPENT DESC
FETCH FIRST 3 ROWS ONLY;
-------------------------------
2. SELECT CUSTOMER_ID, COUNT(ORDER_ID) AS TOTAL_ORDERS
FROM DEMO_ORDERS
GROUP BY CUSTOMER_ID
ORDER BY TOTAL_ORDERS DESC
FETCH FIRST 3 ROWS ONLY;
-----------------
3. SELECT PRODUCT_ID, SUM(QUANTITY) AS TOTAL_QUANTITY_SOLD
FROM DEMO_ORDER_ITEMS
GROUP BY PRODUCT_ID
ORDER BY TOTAL_QUANTITY_SOLD DESC
FETCH FIRST 3 ROWS ONLY;
--------------------------
4. SELECT C.CUST_LAST_NAME, P.PRODUCT_NAME, SUM(OI.QUANTITY) AS TOTAL_QUANTITY
FROM DEMO_CUSTOMERS C
JOIN DEMO_ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID
JOIN DEMO_ORDER_ITEMS OI ON O.ORDER_ID = OI.ORDER_ID
JOIN DEMO_PRODUCTS P ON OI.PRODUCT_ID = P.PRODUCT_ID
GROUP BY C.CUST_LAST_NAME, P.PRODUCT_NAME
ORDER BY C.CUST_LAST_NAME, P.PRODUCT_NAME;
----------------------------------------
5. SELECT *
FROM (
    SELECT C.CUST_LAST_NAME, P.PRODUCT_NAME, SUM(OI.QUANTITY) AS TOTAL_QUANTITY
    FROM DEMO_CUSTOMERS C
    JOIN DEMO_ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID
    JOIN DEMO_ORDER_ITEMS OI ON O.ORDER_ID = OI.ORDER_ID
    JOIN DEMO_PRODUCTS P ON OI.PRODUCT_ID = P.PRODUCT_ID
    GROUP BY C.CUST_LAST_NAME, P.PRODUCT_NAME
) 
PIVOT (
    SUM(TOTAL_QUANTITY) FOR PRODUCT_NAME IN ('Product1', 'Product2', 'Product3') 
);
---------------------------
6. SELECT TO_CHAR(ORDER_TIMESTAMP, 'YYYY') AS ORDER_YEAR, 
       COUNT(ORDER_ID) AS TOTAL_ORDERS
FROM DEMO_ORDERS
GROUP BY TO_CHAR(ORDER_TIMESTAMP, 'YYYY')
ORDER BY TOTAL_ORDERS DESC
FETCH FIRST 1 ROW ONLY;
--------------------------------
8. SELECT CATEGORY, SUM(OI.QUANTITY) AS TOTAL_QUANTITY_SOLD
FROM DEMO_ORDER_ITEMS OI
JOIN DEMO_PRODUCTS P ON OI.PRODUCT_ID = P.PRODUCT_ID
GROUP BY CATEGORY
ORDER BY TOTAL_QUANTITY_SOLD DESC
FETCH FIRST 1 ROW ONLY;
----------------------------------------
9. WITH RankedCategories AS (
    SELECT CATEGORY, 
           SUM(OI.QUANTITY) AS TOTAL_QUANTITY_SOLD,
           ROW_NUMBER() OVER (ORDER BY SUM(OI.QUANTITY) DESC) AS RN
    FROM DEMO_ORDER_ITEMS OI
    JOIN DEMO_PRODUCTS P 
 SELECT C.LAST_NAME, P.PRODUCT_NAME, SUM(OI.QUANTITY) AS TOTAL_QUANTITY
FROM DEMO_CUSTOMERS C
JOIN DEMO_ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID
JOIN DEMO_ORDER_ITEMS OI ON O.ORDER_ID = OI.ORDER_ID
JOIN DEMO_PRODUCTS P ON OI.PRODUCT_ID = P.PRODUCT_ID
GROUP BY ROLLUP(C.LAST_NAME, P.PRODUCT_NAME);
   ON OI.PRODUCT_ID = P.PRODUCT_ID
    GROUP BY CATEGORY
)
SELECT CATEGORY, TOTAL_QUANTITY_SOLD
FROM RankedCategories
WHERE RN = 2;
-----------------------------------
10. SELECT C.CUST_LAST_NAME, P.PRODUCT_NAME, SUM(OI.QUANTITY) AS TOTAL_QUANTITY
FROM DEMO_CUSTOMERS C
JOIN DEMO_ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID
JOIN DEMO_ORDER_ITEMS OI ON O.ORDER_ID = OI.ORDER_ID
JOIN DEMO_PRODUCTS P ON OI.PRODUCT_ID = P.PRODUCT_ID
GROUP BY ROLLUP(C.CUST_LAST_NAME, P.PRODUCT_NAME);
------------------------------

